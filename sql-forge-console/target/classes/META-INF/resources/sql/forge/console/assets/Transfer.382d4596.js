import{X as fe,a as te,g as X,h as q,bD as ge,y as P,d as v,au as ye,i as me,t as be,aV as Ce,W as Oe,R as j,bE as Fe,bt as z,ak as Re,am as Te,S as Se,e as C,m as R,n as r,Z as _e,b2 as Ae,bF as J,bG as Ie,bH as L,bI as Q,ah as Y,ag as we,V as xe,b8 as Me,aZ as ee,ai as Pe,an as Ee}from"./index.ebdafb4c.js";var Ve=function(O){switch(typeof O){case"string":return fe(O,"options","inputValue","option");case"function":return O;default:return null}},je=function(O){te(l,O);function l(){return O!==null&&O.apply(this,arguments)||this}return l.prototype.reload=function(t,n){var e=this.props.reloadOptions;e&&e(t,n)},l.prototype.handleChange=function(t,n){return X(this,void 0,void 0,function(){var e,a,s,d,o,u,i,I,f,b,g,F,x,m,h,E,w,M,T,p;return q(this,function(S){switch(S.label){case 0:return e=this.props,a=e.onChange,s=e.joinValues,d=e.delimiter,o=e.valueField,u=e.extractValue,i=e.options,I=e.dispatchEvent,f=e.setOptions,b=e.selectMode,g=e.deferApi,F=e.deferField,x=F===void 0?"defer":F,m=t,h=i.concat(),E=t,Array.isArray(t)?(m=t.map(function(c){var V=J(i,L(c[o||"value"],o||"value"),{resolve:Ie(o),value:c[o]||"value"});if(!V)h.push(v(v({},c),{visible:!1}));else if(n){var k=Q(h,V);h=Y(h,V,1,v(v({},k),c))}return s||u?c[o||"value"]:c}),s&&(m=m.join(d||","))):t&&(m=s||u?t[o||"value"]:t,w=J(i,L(t[o||"value"],o||"value")),w?n&&(M=Q(h,w),h=Y(h,w,1,v(v({},M),t))):h.push(v(v({},t),{visible:!1}))),T=b==="tree"&&(!!g||!!we(i,function(c){return c.deferApi||c[x]})),(T===!0||h.length>i.length||n)&&f(h,!0),[4,I("change",xe(this.props,{value:m,options:i,items:i,selectedItems:E}))];case 1:return p=S.sent(),p!=null&&p.prevented?[2]:(a(m),[2])}})})},l.prototype.option2value=function(t){return t},l.prototype.getResult=function(t){var n=t.data.options||t.data.items||t.data;return n},l.prototype.handleSearch=function(t,n,e){return X(this,void 0,void 0,function(){var a,s,d,o,u,i,I,f,b,g,F,x,m,h,E,w,M;return q(this,function(T){switch(T.label){case 0:if(a=this.props,s=a.searchApi,d=a.options,o=a.labelField,u=a.valueField,i=a.env,I=a.data,f=a.translate,b=a.filterOption,!s)return[3,5];T.label=1;case 1:return T.trys.push([1,3,,4]),[4,i.fetcher(s,P(I,v({term:t},e||{})),{cancelExecutor:n})];case 2:if(g=T.sent(),!g.ok)throw new Error(f(g.msg||"networkError"));if(F=this.getResult(g),!Array.isArray(F))throw new Error(f("CRUD.invalidArray"));return x={},e&&(x={page:g.data.page,perPage:e.perPage,total:g.data.count}),[2,v({items:Pe(F,function(p){var S=null,c=p[u||"value"];return Array.isArray(d)&&c!==null&&c!==void 0&&(S=Ee(d,L(c,u)),p!=null&&p.children&&(S=v(v({},S),{children:p.children}))),S||p})},x)];case 3:return m=T.sent(),!i.isCancel(m)&&!s.silent&&i.notify("error",m.message),[2,{items:[]}];case 4:return[3,6];case 5:return t?(h=o||"label",E=u||"value",w={keys:[h,E]},b?(M=Ve(b),M?[2,{items:M(d,t,w)}]:(i.notify("error","\u81EA\u5B9A\u4E49\u68C0\u7D22\u51FD\u6570\u4E0D\u7B26\u5408\u8981\u6C42"),[2,{items:[]}])):[2,{items:Me(d,function(p,S,c,V){return!!(Array.isArray(p.children)&&p.children.length||!!ee([p].concat(V),t,{keys:[o||"label",u||"value"],threshold:ee.rankings.CONTAINS}).length)},0,!0)}]):[2,{items:d}];case 6:return[2]}})})},l.prototype.handleResultSearch=function(t,n){var e=this.props,a=e.valueField,s=e.labelField,d=ge(t),o=n[s||"label"],u=n[a||"value"];return d.test(o)||d.test(u)},l.prototype.handlePageChange=function(t,n,e){var a=this.props,s=a.source,d=a.data,o=a.formItem,u=a.onChange,i=P(d,v({page:t!=null?t:1,perPage:n!=null?n:10},e?{pageDir:e}:{}));!o||!ye(o)||(me(s)?o.loadOptionsFromDataScope(s,i,u):be(s,i)&&o.loadOptions(s,i,void 0,!1,u,!1))},l.prototype.optionItemRender=function(t,n){var e=this.props,a=e.menuTpl,s=e.render,d=e.data;return s("item/".concat(n.index),a,{data:P(P(d,n),t)})},l.prototype.resultItemRender=function(t,n){var e=this.props,a=e.valueTpl,s=e.render,d=e.data;return s("value/".concat(n.index),a,{onChange:n.onChange,data:P(P(d,n),t)})},l.prototype.renderCell=function(t,n,e,a){var s=this.props,d=s.render,o=s.data,u=s.classnames,i=s.showInvalidMatch;return d("cell/".concat(e,"/").concat(a),v({type:"text",className:u({"is-invalid":i?n==null?void 0:n.__unmatched:!1})},t),{value:Ce(t.name,n),data:P(o,n)})},l.prototype.getRef=function(t){for(;t&&t.getWrappedInstance;)t=t.getWrappedInstance();this.tranferRef=t},l.prototype.onSelectAll=function(t){var n=this.props,e=n.dispatchEvent,a=n.data;e("selectAll",P(a,{items:t}))},l.prototype.doAction=function(t,n,e){var a,s,d,o,u,i=this.props,I=i.resetValue,f=i.onChange,b=i.formStore,g=i.store,F=i.name;switch(t.actionType){case"clear":f==null||f("");break;case"reset":f==null||f((d=(s=Oe((a=b==null?void 0:b.pristine)!==null&&a!==void 0?a:g==null?void 0:g.pristine,F))!==null&&s!==void 0?s:I)!==null&&d!==void 0?d:"");break;case"selectAll":(o=this.tranferRef)===null||o===void 0||o.selectAll();break;case"clearSearch":{(u=this.tranferRef)===null||u===void 0||u.clearSearch(n);break}}},l.prototype.render=function(){var t,n,e=this.props,a=e.className;e.style;var s=e.classnames,d=e.selectedOptions,o=e.showArrow,u=e.sortable,i=e.selectMode,I=e.columns,f=e.loading,b=e.searchable,g=e.searchResultMode,F=e.searchResultColumns,x=e.deferLoad,m=e.leftMode,h=e.rightMode,E=e.disabled,w=e.selectTitle,M=e.resultTitle,T=e.menuTpl,p=e.valueTpl,S=e.searchPlaceholder,c=e.resultListModeFollowSelect,V=c===void 0?!1:c,k=e.resultSearchPlaceholder,H=e.resultSearchable,ne=H===void 0?!1:H,re=e.statistics,ae=e.labelField,le=e.valueField,ie=e.virtualThreshold,U=e.itemHeight,W=e.loadingConfig,se=e.showInvalidMatch,oe=e.onlyChildren,de=e.mobileUI,ue=e.noResultsText,_=e.pagination,y=e.formItem,N=e.env,B=e.popOverContainer,pe=e.data,K=e.autoCheckChildren,ce=K===void 0?!0:K,Z=e.initiallyOpen,he=Z===void 0?!0:Z,ve=e.testIdBuilder,D=this.props,A=D.options,$=D.leftOptions,G=D.leftDefaultValue;return i==="associated"&&A&&A.length&&A[0].leftOptions&&Array.isArray(A[0].children)&&($=A[0].leftOptions,G=(t=A[0].leftDefaultValue)!==null&&t!==void 0?t:G,A=A[0].children),j.createElement("div",{className:s("TransferControl",a)},j.createElement(Fe,{onlyChildren:oe,value:d,options:A,accumulatedOptions:(n=y==null?void 0:y.accumulatedOptions)!==null&&n!==void 0?n:[],disabled:E,onChange:this.handleChange,option2value:this.option2value,sortable:u,showArrow:o,selectMode:i,searchResultMode:g,searchResultColumns:F,columns:I,onSearch:b?this.handleSearch:void 0,onDeferLoad:x,leftOptions:$,leftMode:m,rightMode:h,cellRender:this.renderCell,selectTitle:w,resultTitle:M,resultListModeFollowSelect:V,onResultSearch:this.handleResultSearch,searchPlaceholder:S,resultSearchable:ne,resultSearchPlaceholder:k,statistics:re,labelField:ae,valueField:le,optionItemRender:T?this.optionItemRender:void 0,resultItemRender:p?this.resultItemRender:void 0,onSelectAll:this.onSelectAll,onRef:this.getRef,virtualThreshold:ie,itemHeight:z(U)>0?z(U):void 0,loadingConfig:W,showInvalidMatch:se,mobileUI:de,noResultsText:ue,pagination:v(v({},Re(_,["className","layout","perPageAvailable","popOverContainerSelector"])),{enable:(_&&_.enable!==void 0?!!(typeof _.enable=="string"?Te(_.enable,pe):_.enable):!!(y!=null&&y.enableSourcePagination))&&(!i||i==="list"||i==="table")&&A.length>0,maxButtons:Number.isInteger(_==null?void 0:_.maxButtons)?_.maxButtons:5,page:y==null?void 0:y.sourcePageNum,perPage:y==null?void 0:y.sourcePerPageNum,total:y==null?void 0:y.sourceTotalNum,popOverContainer:B!=null?B:N==null?void 0:N.getModalContainer}),onPageChange:this.handlePageChange,initiallyOpen:he,autoCheckChildren:ce,testIdBuilder:ve}),j.createElement(Se,{overlay:!0,key:"info",loadingConfig:W,show:f}))},l.defaultProps={multiple:!0},C([R,r("design:type",Function),r("design:paramtypes",[Object,Boolean]),r("design:returntype",Promise)],l.prototype,"handleChange",null),C([R,r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],l.prototype,"option2value",null),C([R,r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],l.prototype,"getResult",null),C([R,r("design:type",Function),r("design:paramtypes",[String,Function,Object]),r("design:returntype",Promise)],l.prototype,"handleSearch",null),C([R,r("design:type",Function),r("design:paramtypes",[String,Object]),r("design:returntype",void 0)],l.prototype,"handleResultSearch",null),C([R,r("design:type",Function),r("design:paramtypes",[Number,Number,String]),r("design:returntype",void 0)],l.prototype,"handlePageChange",null),C([R,r("design:type",Function),r("design:paramtypes",[Object,Object]),r("design:returntype",void 0)],l.prototype,"optionItemRender",null),C([R,r("design:type",Function),r("design:paramtypes",[Object,Object]),r("design:returntype",void 0)],l.prototype,"resultItemRender",null),C([R,r("design:type",Function),r("design:paramtypes",[Object,Object,Number,Number]),r("design:returntype",void 0)],l.prototype,"renderCell",null),C([R,r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],l.prototype,"getRef",null),C([R,r("design:type",Function),r("design:paramtypes",[Array]),r("design:returntype",void 0)],l.prototype,"onSelectAll",null),C([_e(),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],l.prototype,"render",null),l}(j.Component),ke=function(O){te(l,O);function l(){return O!==null&&O.apply(this,arguments)||this}return l}(je),Be=Ae({type:"transfer"})(ke);export{je as BaseTransferRenderer,ke as TransferRender,Be as default,Ve as getCustomFilterOption};
