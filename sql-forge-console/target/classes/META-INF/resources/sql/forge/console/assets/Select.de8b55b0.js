import{a as P,aX as ne,t as W,q as ie,an as J,g as R,h as E,bc as re,d as b,a0 as j,y as H,b as K,R as C,W as le,aq as ae,J as Z,X as se,K as de,e as T,m as S,n as c,Z as ue,bC as pe,S as ce,b2 as Q,V as G}from"./index.329a66e8.js";import{BaseTransferRenderer as he}from"./Transfer.ba2fa49b.js";var Y=function(h){P(i,h);function i(t){var e=h.call(this,t)||this;return e.lastTerm="",e.fetchCancel=null,e.changeValue=e.changeValue.bind(e),e.lazyloadRemote=ne(e.loadRemote.bind(e),250,{trailing:!0,leading:!1}),e.inputRef=e.inputRef.bind(e),e}return i.prototype.componentDidUpdate=function(t){var e=this.props;W(e.autoComplete,e.data)&&ie(t.autoComplete,e.autoComplete,t.data,e.data)&&this.lazyloadRemote(this.lastTerm)},i.prototype.componentWillUnmount=function(){this.unHook&&this.unHook(),this.fetchCancel=null},i.prototype.inputRef=function(t){this.input=t},i.prototype.focus=function(){var t,e;this.input&&((e=(t=this.input)===null||t===void 0?void 0:t.focus)===null||e===void 0||e.call(t))},i.prototype.getValue=function(t,e){e===void 0&&(e=[]);var o=this.props,n=o.joinValues,l=o.extractValue,a=o.delimiter,r=o.multiple,s=o.valueField,d=o.options,u=t;return(Array.isArray(t)?t:t?[t]:[]).forEach(function(p){var m=J(d,function(f){return f[s||"value"]==p[s||"value"]});m||e.push(p)}),n?r?u=Array.isArray(t)?t.map(function(p){return p[s||"value"]}).join(a):t?t[s||"value"]:"":u=u?u[s||"value"]:"":l&&(r?u=Array.isArray(t)?t.map(function(p){return p[s||"value"]}):t?[t[s||"value"]]:[]:u=u?u[s||"value"]:""),u},i.prototype.dispatchEvent=function(t,e){return e===void 0&&(e={}),R(this,void 0,void 0,function(){var o,n,l,a,r,s,d,u;return E(this,function(p){switch(p.label){case 0:return o="on"+t.charAt(0).toUpperCase()+t.slice(1),n=this.props,l=n.dispatchEvent,a=n.options,r=n.value,s=n.multiple,d=n.selectedOptions,[4,l(t,G(this.props,{options:a,items:a,value:r,selectedItems:s?d:d[0]}))];case 1:return u=p.sent(),u!=null&&u.prevented?[2]:(this.props[o](e),[2])}})})},i.prototype.changeValue=function(t){return R(this,void 0,void 0,function(){var e,o,n,l,a,r,s,d;return E(this,function(u){switch(u.label){case 0:return e=this.props,o=e.onChange,n=e.setOptions,l=e.options,e.data,a=e.dispatchEvent,r=[],s=this.getValue(t,r),r.length&&n(l.concat(r)),[4,a("change",G(this.props,{value:s,options:l,items:l,selectedItems:t}))];case 1:return d=u.sent(),d!=null&&d.prevented?[2]:(o==null||o(s),[2])}})})},i.prototype.loadRemote=function(t,e){var o;return e===void 0&&(e=!1),R(this,void 0,void 0,function(){var n,l,a,r,s,d,u,p,m,f,g,v,w=this;return E(this,function(O){switch(O.label){case 0:if(n=this.props,l=n.autoComplete,a=n.env,r=n.data,s=n.setOptions,d=n.setLoading,u=n.formInited,p=n.addHook,!a||!a.fetcher)throw new Error("fetcher is required");if(!e&&u===!1&&p)return this.unHook&&this.unHook(),[2,this.unHook=p(this.loadRemote.bind(this,t,!0),"init")];if(this.lastTerm=t,m=H(r,{term:t,value:t}),!W(l,m))return[2,Promise.resolve({options:[]})];this.fetchCancel&&((o=this.fetchCancel)===null||o===void 0||o.call(this,"autoComplete request cancelled."),this.fetchCancel=null,d(!1)),d(!0),O.label=1;case 1:return O.trys.push([1,,3,4]),[4,a.fetcher(l,m,{cancelExecutor:function(M){return w.fetchCancel=M}})];case 2:return f=O.sent(),this.fetchCancel=null,g=f.data&&f.data.options||f.data||[],v=this.mergeOptions(g),s(v),[2,{options:v}];case 3:return d(!1),[7];case 4:return[2]}})})},i.prototype.mergeOptions=function(t){var e=this.props,o=e.selectedOptions,n=e.valueField,l=n===void 0?"value":n,a=re(t,void 0,l).concat();return Array.isArray(o)&&o.length&&o.forEach(function(r){J(a,function(s){return s[l]===r[l]})||a.push(b(b({},r),{hidden:!0}))}),a},i.prototype.renderMenu=function(t,e){var o=this.props,n=o.menuTpl,l=o.render,a=o.data,r=o.optionClassName,s=o.testIdBuilder;return l("menu/".concat(e.index),n,{showNativeTitle:!0,className:j("Select-option-content",r),data:H(H(a,e),t),testIdBuilder:s==null?void 0:s.getChild("option-"+t.value||e.index)})},i.prototype.reload=function(t,e){var o=this.props.reloadOptions;o&&o(t,e)},i.prototype.option2value=function(){},i.prototype.renderOtherMode=function(){var t=this.props,e=t.selectMode,o=K(t,["selectMode"]);return C.createElement(ve,b({},o,{selectMode:e==="group"?"list":e}))},i.prototype.doAction=function(t,e,o){var n,l,a,r=this.props,s=r.resetValue,d=r.onChange,u=r.formStore,p=r.store,m=r.name,f=r.valueField,g=t==null?void 0:t.actionType;if(g==="clear")d==null||d("");else if(g==="reset"){var v=(a=le((l=u==null?void 0:u.pristine)!==null&&l!==void 0?l:p==null?void 0:p.pristine,m))!==null&&a!==void 0?a:s,w=this.getValue((n={},n[f]=v!=null?v:"",n));d==null||d(w)}},i.prototype.handleOptionAdd=function(t,e,o,n){var l=this;t===void 0&&(t=-1),o===void 0&&(o=!1);var a=this.props,r=a.onAdd,s=a.autoComplete;r==null||r(t,e,o,function(){return R(l,void 0,void 0,function(){return E(this,function(d){switch(d.label){case 0:return n==null||n(e),s?[4,this.loadRemote(this.lastTerm)]:[3,2];case 1:return d.sent(),[2,!1];case 2:return[2]}})})})},i.prototype.handleOptionEdit=function(t,e,o,n){var l=this,a=this.props,r=a.onEdit,s=a.autoComplete;r==null||r(t,e,o,function(){return R(l,void 0,void 0,function(){return E(this,function(d){switch(d.label){case 0:return n==null||n(t),s?[4,this.loadRemote(this.lastTerm)]:[3,2];case 1:return d.sent(),[2,!1];case 2:return[2]}})})})},i.prototype.handleOptionDelete=function(t,e){var o=this,n=this.props,l=n.onDelete,a=n.autoComplete;l==null||l(t,function(){return R(o,void 0,void 0,function(){return E(this,function(r){switch(r.label){case 0:return e==null||e(t),a?[4,this.loadRemote(this.lastTerm)]:[3,2];case 1:return r.sent(),[2,!1];case 2:return[2]}})})})},i.prototype.render=function(){var t=this,e=this.props,o=e.autoComplete,n=e.searchable,l=e.showInvalidMatch,a=e.options,r=e.className,s=e.popoverClassName,d=e.style,u=e.loading;e.value;var p=e.selectedOptions,m=e.multi,f=e.multiple,g=e.placeholder,v=e.id,w=e.classPrefix;e.classnames;var O=e.creatable;e.inline;var M=e.noResultsText,L=e.render,U=e.menuTpl,k=e.borderMode,B=e.selectMode,_=e.env,x=e.mobileUI,q=e.overlay,A=e.filterOption,V=K(e,["autoComplete","searchable","showInvalidMatch","options","className","popoverClassName","style","loading","value","selectedOptions","multi","multiple","placeholder","id","classPrefix","classnames","creatable","inline","noResultsText","render","menuTpl","borderMode","selectMode","env","mobileUI","overlay","filterOption"]),D=this.props,I=D.classPrefix,F=D.themeCss;return M&&(M=L("noResultText",M)),C.createElement("div",{className:j("".concat(w,"SelectControl"),r),style:d},["table","list","group","tree","chained","associated"].includes(B)?this.renderOtherMode():C.createElement(ae,b({},V,{onAdd:this.handleOptionAdd,onEdit:this.handleOptionEdit,onDelete:this.handleOptionDelete,className:j(Z(b(b({},this.props),{name:"selectControlClassName",id:v,themeCss:F}))),popoverClassName:j(s,Z(b(b({},this.props),{name:"selectPopoverClassName",id:v,themeCss:F}))),mobileUI:x,popOverContainer:x?_==null?void 0:_.getModalContainer:V.popOverContainer||_.getModalContainer,borderMode:k,placeholder:g,multiple:f||m,ref:this.inputRef,value:p,options:a,filterOption:typeof A=="string"?se(A,"options","inputValue","option"):A,loadOptions:W(o)?this.lazyloadRemote:void 0,showInvalidMatch:l,creatable:O,searchable:n||!!o,onChange:this.changeValue,onBlur:function(N){return t.dispatchEvent("blur",N)},onFocus:function(N){return t.dispatchEvent("focus",N)},loading:u,noResultsText:M,renderMenu:U?this.renderMenu:void 0,overlay:q})),C.createElement(de,b({},this.props,{config:{themeCss:F,classNames:[{key:"selectControlClassName",weights:{focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"selectPopoverClassName",weights:{default:{suf:" .".concat(I,"Select-option")},hover:{suf:" .".concat(I,"Select-option.is-highlight")},focused:{inner:".".concat(I,"Select-option.is-active")}}}],id:v},env:_})))},i.defaultProps={clearable:!1,searchable:!1,multiple:!1,showInvalidMatch:!1},T([S,c("design:type",Function),c("design:paramtypes",[Object,Object]),c("design:returntype",void 0)],i.prototype,"renderMenu",null),T([S,c("design:type",Function),c("design:paramtypes",[Object,Object,Boolean,Function]),c("design:returntype",void 0)],i.prototype,"handleOptionAdd",null),T([S,c("design:type",Function),c("design:paramtypes",[Object,Object,Boolean,Function]),c("design:returntype",void 0)],i.prototype,"handleOptionEdit",null),T([S,c("design:type",Function),c("design:paramtypes",[Object,Function]),c("design:returntype",void 0)],i.prototype,"handleOptionDelete",null),T([ue(),c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",void 0)],i.prototype,"render",null),i}(C.Component),ve=function(h){P(i,h);function i(){return h!==null&&h.apply(this,arguments)||this}return i.prototype.renderItem=function(t){var e=this.props,o=e.labelField,n=e.menuTpl,l=e.data,a=e.render;return n?a("option/".concat(t.value),n,{data:H(l,t)}):"".concat(t.scopeLabel||"").concat(t[o||"label"])},i.prototype.render=function(){var t,e=this.props,o=e.className;e.classnames;var n=e.selectedOptions,l=e.sortable,a=e.loading,r=e.searchable,s=e.searchResultMode,d=e.showArrow,u=e.deferLoad,p=e.disabled,m=e.clearable,f=e.selectTitle,g=e.selectMode,v=e.multiple,w=e.columns,O=e.leftMode,M=e.borderMode,L=e.mobileUI,U=e.env,k=e.popOverContainer,B=e.maxTagCount,_=e.overflowTagPopover,x=e.placeholder,q=e.itemHeight,A=e.virtualThreshold,V=e.rightMode,D=e.loadingConfig,I=e.labelField,F=e.showInvalidMatch,N=e.checkAll,ee=e.checkAllLabel,te=e.overlay,oe=e.valueField,z=this.props,y=z.options,X=z.leftOptions,$=z.leftDefaultValue;return g==="associated"&&y&&y.length&&y[0].leftOptions&&Array.isArray(y[0].children)&&(X=y[0].leftOptions,$=(t=y[0].leftDefaultValue)!==null&&t!==void 0?t:$,y=y[0].children),C.createElement(C.Fragment,null,C.createElement(pe,{selectMode:g,className:o,value:n,disabled:p,clearable:m,options:y,onChange:this.handleChange,option2value:this.option2value,optionItemRender:this.renderItem,itemRender:this.renderItem,sortable:l,searchResultMode:s,onSearch:r?this.handleSearch:void 0,showArrow:d,onDeferLoad:u,selectTitle:f,multiple:v,columns:w,leftMode:O,rightMode:V,leftOptions:X,borderMode:M,mobileUI:L,popOverContainer:k||U.getModalContainer,maxTagCount:B,overflowTagPopover:_,placeholder:x,itemHeight:q,virtualThreshold:A,virtualListHeight:266,labelField:I,showInvalidMatch:F,checkAllLabel:ee,checkAll:N,overlay:te,valueField:oe}),C.createElement(ce,{overlay:!0,key:"info",show:a,loadingConfig:D}))},T([S,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Object)],i.prototype,"renderItem",null),i}(he),ge=function(h){P(i,h);function i(){return h!==null&&h.apply(this,arguments)||this}return i=T([Q({type:"select"})],i),i}(Y),ye=function(h){P(i,h);function i(){return h!==null&&h.apply(this,arguments)||this}return i.defaultProps={multiple:!0},i=T([Q({type:"multi-select"})],i),i}(Y);export{ye as MultiSelectControlRenderer,ge as SelectControlRenderer,Y as default};
