import{a as me,aX as ge,an as D,r as x,al as se,aC as Ce,d as y,W as ie,a6 as Ke,aA as ce,z as j,g as P,h as X,c_ as Ne,k as ue,R as b,J as U,y as he,a7 as ve,c1 as pe,C as q,K as oe,c0 as Ee,e as T,m as g,n as c,o as _e,f as Ae,V as ye,c2 as Se}from"./index.329a66e8.js";var we=function(z){me(l,z);function l(e){var t=z.call(this,e)||this;t.newTabDefaultId=3,t.lazySwitchTo=ge(t.switchTo.bind(t),250,{leading:!0,trailing:!1});var a=e.location||window.location,s=e.tabs,i=e.source,r=e.data,o=0;if(typeof e.activeKey!="undefined")o=e.activeKey;else if(a&&Array.isArray(s)){var h=a.hash.substring(1),u=D(s,function(E){return E.hash===h});u?o=u.hash:e.defaultKey!==void 0?o=typeof e.defaultKey=="string"?x(e.defaultKey,e.data):e.defaultKey:e.defaultActiveKey&&(o=typeof e.defaultActiveKey=="string"?x(e.defaultActiveKey,e.data):e.defaultActiveKey),o=o||s[0]&&s[0].hash||0}var p=se(t.initTabArray(s,i,r),2),v=p[0],C=p[1];return t.state={prevKey:void 0,activeKey:t.activeKey=o,localTabs:v,isFromSource:C},t}return l.prototype.initTabArray=function(e,t,a){if(!e)return[[],!1];var s=x(t,a,"| raw");if(!Array.isArray(s))return[e,!1];e=Array.isArray(e)?e:[e];var i=[];return s.forEach(function(r){i.push.apply(i,Ce([],se(e.map(function(o){return y(y({},o),{data:r})})),!1))}),[i,!0]},l.prototype.componentDidMount=function(){var e,t;this.autoJumpToNeighbour(this.activeKey);var a=this.props,s=a.name,i=a.value,r=a.onChange,o=a.source;a.tabs;var h=a.data,u=this.state.localTabs;if(!(!s||typeof r!="function"||o))if(i=i!=null?i:ie(h,s),i&&Array.isArray(u)){var p=this.resolveKeyByValue(i);p!==void 0&&this.handleSelect(p)}else{var v=this.resolveTabByKey(this.activeKey);v&&i!==((e=v.value)!==null&&e!==void 0?e:v.title)&&r((t=v.value)!==null&&t!==void 0?t:v.title,s)}},l.prototype.componentDidUpdate=function(e,t){var a,s,i,r=this.props,o=this.state.localTabs,h=x(e.defaultActiveKey,e.data),u=x(r.defaultActiveKey,r.data),p=Ke({tabs:r.tabs,source:x(r.source,r.data,"| raw")},{tabs:e.tabs,source:x(e.source,e.data,"| raw")},!1);if(p){var v=se(this.initTabArray(r.tabs,r.source,r.data),2),C=v[0],E=v[1];this.setState({localTabs:C,isFromSource:E}),o=C}if(r.location&&e.location&&r.location.hash!==e.location.hash){var S=r.location.hash.substring(1);if(!S)return;var m=D(o,function(I){return I.hash===S});m&&m.hash&&m.hash!==this.state.activeKey&&this.setState({activeKey:this.activeKey=m.hash,prevKey:this.state.activeKey})}else if(Array.isArray(o)&&Array.isArray(t.localTabs)&&JSON.stringify(o.map(function(I){return I.hash}))!==JSON.stringify(t.localTabs.map(function(I){return I.hash}))){var _=this.state.activeKey,V=r.location,m=null;if(V&&Array.isArray(o)){var k=V.hash.substring(1);m=D(o,function(A){return A.hash===k})}m?_=m.hash:(!o||!o.some(function(A,Z){return A.hash?A.hash===_:Z===_}))&&(_=o&&o[0]&&o[0].hash||0),this.setState({prevKey:void 0,activeKey:this.activeKey=_})}else if(h!==u){if(u==null)return;var w=null,m=D(o,function(A){return A.hash===u});m?w=m.hash:typeof u=="number"&&o[u]&&(w=u),w!==null&&this.setState({prevKey:h,activeKey:this.activeKey=w})}this.autoJumpToNeighbour(this.activeKey);var O=this.props,H=O.name,K=O.value,J=O.onChange,G=O.source,Q=O.data;if(!(!H||typeof J!="function"||G)){var R;K=K!=null?K:ie(Q,H);var Y=(a=e.value)!==null&&a!==void 0?a:ie(e.data,e.name);if(K!==Y&&(R=this.resolveKeyByValue(K))!==void 0&&R!==this.activeKey)this.handleSelect(R);else if(this.activeKey!==t.activeKey){var m=this.resolveTabByKey(this.activeKey);m&&K!==((s=m.value)!==null&&s!==void 0?s:m.title)&&J((i=m.value)!==null&&i!==void 0?i:m.title,H)}}},l.prototype.componentWillUnmount=function(){this.lazySwitchTo.cancel()},l.prototype.resolveTabByKey=function(e){var t=this.state.localTabs;if(!!Array.isArray(t))return D(t,function(a,s){return a.hash?a.hash===e:s===e})},l.prototype.resolveKeyByValue=function(e){var t=this.state.localTabs;if(!!Array.isArray(t)){var a=D(t,function(s){var i;return((i=s.value)!==null&&i!==void 0?i:s.title)===e});return a&&a.hash?a.hash:t.indexOf(a)}},l.prototype.autoJumpToNeighbour=function(e){var t=this.props;t.tabs;var a=t.data,s=this.state.localTabs;if(!!Array.isArray(s)){var i=ce(s,function(p,v){return p.hash?p.hash===e:v===e});if(s[i]&&!j(s[i],this.props.data))for(var r=s.length,o=i,h=i;o-->=0||h++<r;){var u=null;if(o>=0&&j(s[o],a)?u=s[o].hash||o:h<r&&j(s[h],a)&&(u=s[h].hash||h),u!==null){this.setState({activeKey:this.activeKey=u});break}}}},l.prototype.handleAdd=function(){var e=this,t=this.state.localTabs.concat();t.push({title:"tab".concat(this.newTabDefaultId++),body:"tab"}),this.setState({localTabs:t},function(){e.switchTo(e.state.localTabs.length-1)})},l.prototype.handleClose=function(e,t){return P(this,void 0,void 0,function(){var a,s,i,r;return X(this,function(o){switch(o.label){case 0:return a=this.state.localTabs.concat(),s=a==null?void 0:a.findIndex(function(h,u){var p;return e===(t?h.hash:(p=h.hash)!==null&&p!==void 0?p:u)}),s===-1?[2]:(a.splice(s,1),i=this.props.dispatchEvent,[4,i("delete",ye(this.props,{value:e}))]);case 1:return r=o.sent(),r!=null&&r.prevented?[2]:(this.setState({localTabs:a}),[2])}})})},l.prototype.handleEdit=function(e,t){var a=this.state.localTabs.concat();a[e].title=t,this.setState({localTabs:a})},l.prototype.handleDragChange=function(e){return P(this,void 0,void 0,function(){var t,a,s=this;return X(this,function(i){return t=this.resolveTabByKey(this.activeKey),a=this.state.localTabs.concat(),a.splice(e.newIndex,0,a.splice(e.oldIndex,1)[0]),this.setState({localTabs:a},function(){if(t){var r=a.indexOf(t);s.switchTo(r)}}),[2]})})},l.prototype.handleSelect=function(e){var t;return P(this,void 0,void 0,function(){var a,s,i,r,o,h,u,p,v;return X(this,function(C){switch(C.label){case 0:return a=this.props,s=a.dispatchEvent,a.data,i=a.env,r=a.onSelect,o=a.id,h=this.state.localTabs,u=h==null?void 0:h.find(function(E,S){return e===(E.hash?E.hash:S)}),u?((t=i.tracker)===null||t===void 0||t.call(i,{eventType:"tabChange",eventData:{id:o,key:e}}),[4,s("change",ye(this.props,{value:u!=null&&u.hash?u==null?void 0:u.hash:e+1}))]):[2];case 1:return p=C.sent(),p!=null&&p.prevented?[2]:(typeof e=="string"&&i?i.updateLocation("#".concat(e)):typeof this.state.activeKey=="string"&&i&&i.updateLocation("#"),this.setState({activeKey:this.activeKey=e,prevKey:this.state.activeKey}),typeof r=="string"?(v=Se(r,"key","props"),v&&v(e,this.props)):typeof r=="function"&&r(e,this.props),[2])}})})},l.prototype.doAction=function(e,t,a,s){var i=e==null?void 0:e.actionType,r=Number(s==null?void 0:s.activeKey),o=Ne(r)?s==null?void 0:s.activeKey:r,h=s==null?void 0:s.deleteHash;i==="changeActiveKey"?this.handleSelect(typeof o=="number"?o-1:o):i==="deleteTab"&&this.handleClose(h,!0)},l.prototype.switchTo=function(e,t){var a=this.state.localTabs;Array.isArray(a)&&a[e]&&this.setState({activeKey:this.activeKey=a[e].hash||e},t)},l.prototype.currentIndex=function(){var e=this,t=this.state.localTabs;return Array.isArray(t)?ce(t,function(a,s){return a.hash?a.hash===e.state.activeKey:s===e.state.activeKey}):-1},l.prototype.dispatchEvent=function(e,t,a,s){return P(this,void 0,void 0,function(){var i;return X(this,function(r){return e==="formItemValidateError"&&(i=a==null?void 0:a.props.tabIndex,typeof i=="number"&&this.lazySwitchTo(i)),[2,this.props.dispatchEvent(e,t,a,s)]})})},l.prototype.renderTabTitle=function(e,t,a){var s=this.props.render;return typeof e=="string"||!e?ue(e,a):s("tab-title/".concat(t),e,{data:y({index:t,__index:t},a)})},l.prototype.renderToolbar=function(){var e=this.props,t=e.toolbar,a=e.render,s=e.classnames,i=e.toolbarClassName,r=e.id,o=e.themeCss;return t?b.createElement("div",{className:s("Tabs-toolbar",i,U(y(y({},this.props),{name:"toolbarControlClassName",id:r,themeCss:o})))},a("toolbar",t)):null},l.prototype.renderTabs=function(){var e=this,t=this.props,a=t.classnames,s=t.classPrefix,i=t.contentClassName,r=t.linksClassName,o=t.tabRender,h=t.className,u=t.style,p=t.render,v=t.data,C=t.mode,E=t.tabsMode,S=t.unmountOnExit;t.source;var m=t.formStore,_=t.formMode,V=t.formHorizontal,k=t.subFormMode,w=t.subFormHorizontal,O=t.addable,H=t.closable,K=t.draggable,J=t.showTip,G=t.showTipClassName,Q=t.editable,R=t.sidePosition,Y=t.translate,I=t.addBtnText,A=t.collapseOnExceed,Z=t.collapseBtnLabel,L=t.disabled,$=t.mobileUI,re=t.swipeable,F=t.testIdBuilder,W=t.id,le=t.wrapperCustomStyle,ee=t.themeCss,fe=t.env,be=E||C,te=this.props.mountOnEnter;m&&(te=!1);var de=this.state,f=de.localTabs,Te=de.isFromSource,ae=[],ne=[];return Te?(ae=f.map(function(n,d){var N,B,M=he(v,ve(n.data)?y({index:d},n.data):{item:n.data,index:d});return j(n,M)?b.createElement(pe,y({},n,{title:e.renderTabTitle(n.title,d,M),disabled:L||q(n,M),key:d,eventKey:ue(n.hash,M)||d,prevKey:d>0?((N=f[d-1])===null||N===void 0?void 0:N.hash)||d-1:0,nextKey:d<f.length-1?((B=f[d+1])===null||B===void 0?void 0:B.hash)||d+1:f.length-1,swipeable:re,mobileUI:$,mountOnEnter:te,unmountOnExit:typeof n.reload=="boolean"?n.reload:typeof n.unmountOnExit=="boolean"?n.unmountOnExit:S,onSelect:e.handleSelect,testIdBuilder:F==null?void 0:F.getChild("tab-".concat(typeof n.title=="string"?n.title:d)),className:a(n.className,U(y(y({},n),{name:"panelControlClassName",id:n.id,themeCss:n.themeCss})))}),p("item/".concat(d),n!=null&&n.type?n:n.tab||n.body,{tabIndex:d,dispatchEvent:e.dispatchEvent,disabled:L||q(n,M)||void 0,data:M,formMode:n.mode||k||_,formHorizontal:n.horizontal||w||V})):null}),ne=f.map(function(n,d){var N=he(v,ve(n.data)?y({index:d},n.data):{item:n.data,index:d});return j(n,N)?b.createElement(oe,y({},n,{config:{id:n.id,themeCss:n.themeCss,classNames:[{key:"panelControlClassName"}]},env:e.props.env,key:"customstyle_".concat(d)})):null})):(ae=f.map(function(n,d){var N,B;return j(n,v)?b.createElement(pe,y({},n,{title:e.renderTabTitle(n.title,d,v),disabled:L||q(n,v),key:d,eventKey:n.hash||d,prevKey:d>0?((N=f[d-1])===null||N===void 0?void 0:N.hash)||d-1:0,nextKey:d<f.length-1?((B=f[d+1])===null||B===void 0?void 0:B.hash)||d+1:f.length-1,swipeable:re,mobileUI:$,mountOnEnter:te,unmountOnExit:typeof n.reload=="boolean"?n.reload:typeof n.unmountOnExit=="boolean"?n.unmountOnExit:S,onSelect:e.handleSelect,testIdBuilder:F==null?void 0:F.getChild("tab-".concat(typeof n.title=="string"?n.title:d)),className:a(n.className,U(y(y({},n),{name:"panelControlClassName",id:n.id,themeCss:n.themeCss})))}),e.renderTab?e.renderTab(n,e.props,d):o?o(n,e.props,d):p("tab/".concat(d),n!=null&&n.type?n:n.tab||n.body,{tabIndex:d,dispatchEvent:e.dispatchEvent,disabled:L||q(n,v)||void 0,formMode:n.mode||k||_,formHorizontal:n.horizontal||w||V})):null}),ne=f.map(function(n,d){return j(n,v)?b.createElement(oe,{config:{id:n.id,themeCss:n.themeCss,classNames:[{key:"panelControlClassName"}]},env:e.props.env,key:"customstyle_".concat(d)}):null})),b.createElement(b.Fragment,null,b.createElement(Ee,{addBtnText:Y(I||"add"),classPrefix:s,classnames:a,mode:be,closable:H,className:a(h,U(y(y({},this.props),{name:"wrapperCustomStyle",id:W,themeCss:le}))),style:u,contentClassName:a(i,U(y(y({},this.props),{name:"contentControlClassName",id:W,themeCss:ee}))),linksClassName:r,titleClassName:a(U(y(y({},this.props),{name:"titleControlClassName",id:W,themeCss:ee}))),onSelect:this.handleSelect,activeKey:this.state.activeKey,toolbar:this.renderToolbar(),addable:O,onAdd:this.handleAdd,onClose:this.handleClose,draggable:K,onDragChange:this.handleDragChange,showTip:J,showTipClassName:G,editable:Q,onEdit:this.handleEdit,sidePosition:R,collapseOnExceed:A,collapseBtnLabel:Z,mobileUI:$,testIdBuilder:F},ae),ne,b.createElement(oe,y({},this.props,{config:{wrapperCustomStyle:le,id:W,themeCss:ee,classNames:[{key:"titleControlClassName",weights:{default:{important:!0,inner:"> a"},focused:{important:!0,suf:".is-active",inner:"> a"},hover:{important:!0,inner:"> a"},disabled:{important:!0,suf:".is-disabled",inner:"> a"}}},{key:"toolbarControlClassName",weights:{default:{important:!0}}},{key:"contentControlClassName",weights:{default:{important:!0}}}]},env:fe})))},l.prototype.render=function(){return this.renderTabs()},l.defaultProps={className:"",mode:"",mountOnEnter:!0,unmountOnExit:!1},T([g,c("design:type",Function),c("design:paramtypes",[Array,String,Object]),c("design:returntype",Array)],l.prototype,"initTabArray",null),T([g,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",void 0)],l.prototype,"autoJumpToNeighbour",null),T([g,c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",void 0)],l.prototype,"handleAdd",null),T([g,c("design:type",Function),c("design:paramtypes",[Object,Boolean]),c("design:returntype",Promise)],l.prototype,"handleClose",null),T([g,c("design:type",Function),c("design:paramtypes",[Number,String]),c("design:returntype",void 0)],l.prototype,"handleEdit",null),T([g,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],l.prototype,"handleDragChange",null),T([g,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],l.prototype,"handleSelect",null),T([g,c("design:type",Function),c("design:paramtypes",[Number,Function]),c("design:returntype",void 0)],l.prototype,"switchTo",null),T([g,c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",Number)],l.prototype,"currentIndex",null),T([g,c("design:type",Function),c("design:paramtypes",[Object,Object,b.Component,Object]),c("design:returntype",Promise)],l.prototype,"dispatchEvent",null),l}(b.Component),Ie=function(z){me(l,z);function l(e,t){var a=z.call(this,e)||this,s=t;return s.registerComponent(a),a}return l.prototype.componentWillUnmount=function(){var e;(e=z.prototype.componentWillUnmount)===null||e===void 0||e.call(this);var t=this.context;t.unRegisterComponent(this)},l.contextType=_e,l=T([Ae({type:"tabs"}),c("design:paramtypes",[Object,Object])],l),l}(we);export{Ie as TabsRenderer,we as default};
